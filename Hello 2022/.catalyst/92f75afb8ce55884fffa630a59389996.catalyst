{"title":{"en":"E. Masha-forgetful","ru":"E. Маша-забываша"},"contestId":"1624","problemIndex":"E","timeLimit":{"en":"3 seconds","ru":"3 секунды"},"memLimit":{"en":"256 megabytes","ru":"256 мегабайт"},"inputFormat":{"en":"standard input","ru":"стандартный ввод"},"outputFormat":{"en":"standard output","ru":"стандартный вывод"},"problemHtml":{"en":"<p>Masha meets a new friend and learns his phone number&nbsp;— $$$s$$$. She wants to remember it as soon as possible. The phone number&nbsp;— is a string of length $$$m$$$ that consists of digits from $$$0$$$ to $$$9$$$. The phone number may start with <span class=\"tex-font-style-tt\">0</span>.</p><p>Masha already knows $$$n$$$ phone numbers (all numbers have the same length $$$m$$$). It will be easier for her to remember a new number if the $$$s$$$ is represented as segments of numbers she already knows. Each such segment must be of length <span class=\"tex-font-style-bf\">at least $$$2$$$</span>, otherwise there will be too many segments and Masha will get confused.</p><p>For example, Masha needs to remember the number: $$$s = $$$ '<span class=\"tex-font-style-tt\">12345678</span>' and she already knows $$$n = 4$$$ numbers: '<span class=\"tex-font-style-tt\">12340219</span>', '<span class=\"tex-font-style-tt\">20215601</span>', '<span class=\"tex-font-style-tt\">56782022</span>', '<span class=\"tex-font-style-tt\">12300678</span>'. You can represent $$$s$$$ as a $$$3$$$ segment: '<span class=\"tex-font-style-tt\">1234</span>' of number one, '<span class=\"tex-font-style-tt\">56</span>' of number two, and '<span class=\"tex-font-style-tt\">78</span>' of number three. There are other ways to represent $$$s$$$.</p><p>Masha asks you for help, she asks you to break the string $$$s$$$ into segments of length $$$2$$$ or more of the numbers she already knows. If there are several possible answers, print <span class=\"tex-font-style-bf\">any</span> of them.</p>","ru":"<p>Маша познакомилась с новым другом и узнала его номер телефона&nbsp;— $$$s$$$. Она хочет как можно скорее запомнить его. Номер телефона&nbsp;— это строка длины $$$m$$$, которая состоит из цифр от $$$0$$$ до $$$9$$$. Допустимо, что телефон начинается с <span class=\"tex-font-style-tt\">0</span>.</p><p>Маша уже знает $$$n$$$ номеров телефонов (все номера имеют одинаковую длину $$$m$$$). Ей будет проще запомнить новый номер, если строку $$$s$$$ представить как отрезки уже известных ей номеров. Каждый такой отрезок должен быть длины <span class=\"tex-font-style-bf\">не менее $$$2$$$</span>, иначе отрезков будет слишком много, и Маша запутается.</p><p>Например, Маше нужно запомнить номер: $$$s = $$$ «<span class=\"tex-font-style-tt\">12345678</span>» и она уже знает $$$n = 4$$$ номера: «<span class=\"tex-font-style-tt\">12340219</span>», «<span class=\"tex-font-style-tt\">20215601</span>», «<span class=\"tex-font-style-tt\">56782022</span>», «<span class=\"tex-font-style-tt\">12300678</span>». Можно представить $$$s$$$ как $$$3$$$ отрезка: «<span class=\"tex-font-style-tt\">1234</span>» из первого номера, «<span class=\"tex-font-style-tt\">56</span>» из второго номера и «<span class=\"tex-font-style-tt\">78</span>» из третьего номера. Есть и другие способы представления $$$s$$$.</p><p>Маша обратилась к вам за помощью, она просит вас разбить строку $$$s$$$ на отрезки длины $$$2$$$ или более из уже известных ей номеров. Если существует несколько возможных ответов, выведите <span class=\"tex-font-style-bf\">любой</span> из них.</p>"},"inSpecsHtml":{"en":"<div class=\"section-title\">Input</div><p>The first line of input data contains an integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$)&nbsp;—the number of test cases.</p><p>Before each test case there is a blank line. Then there is a line containing integers $$$n$$$ and $$$m$$$ ($$$1 \\le n, m \\le 10^3$$$)&nbsp;—the number of phone numbers that Masha knows and the number of digits in each phone number. Then follow $$$n$$$ line, $$$i$$$-th of which describes the $$$i$$$-th number that Masha knows. The next line contains the phone number of her new friend $$$s$$$.</p><p>Among the given $$$n+1$$$ phones, there may be duplicates (identical phones).</p><p>It is guaranteed that the sum of $$$n \\cdot m$$$ ($$$n$$$ multiplied by $$$m$$$) values over all input test cases does not exceed $$$10^6$$$.</p>","ru":"<div class=\"section-title\">Входные данные</div><p>В первой строке входных данных записано целое число $$$t$$$ ($$$1 \\le t \\le 10^4$$$)&nbsp;— количество наборов входных данных в тесте.</p><p>Перед каждым набором в тесте записана пустая строка. Далее идёт строка, которая содержит целые числа $$$n$$$ и $$$m$$$ ($$$1 \\le n, m \\le 10^3$$$)&nbsp;— количество номеров, которые знает Маша и количество цифр в каждом номере. Затем следуют $$$n$$$ строк, $$$i$$$-я из которых описывает $$$i$$$-й номер, который знает Маша. Следующая строка содержит номер телефона её нового друга $$$s$$$.</p><p>Среди заданных $$$n+1$$$ телефонов могут быть дубликаты (одинаковые телефоны).</p><p>Гарантируется, что сумма значений $$$n \\cdot m$$$ ($$$n$$$ умножить на $$$m$$$) по всем наборам входных данных в тесте не превосходит $$$10^6$$$.</p>"},"outSpecsHtml":{"en":"<div class=\"section-title\">Output</div><p>You need to print the answers to $$$t$$$ test cases. The first line of the answer should contain one number $$$k$$$, corresponding to the number of segments into which you split the phone number $$$s$$$. Print <span class=\"tex-font-style-tt\">-1</span> if you cannot get such a split.</p><p>If the answer is yes, then follow $$$k$$$ lines containing triples of numbers $$$l, r, i$$$. Such triplets mean that the next $$$r-l+1$$$ digits of number $$$s$$$ are equal to a segment (substring) with boundaries $$$[l, r]$$$ of the phone under number $$$i$$$. Both the phones and the digits in them are numbered from $$$1$$$. Note that $$$r-l+1 \\ge 2$$$ for all $$$k$$$ lines.</p>","ru":"<div class=\"section-title\">Выходные данные</div><p>Вам нужно вывести ответы на $$$t$$$ запросов. В первой строке ответа должно содержаться одно число $$$k$$$, соответствующее количеству отрезков, на которые вы разбили номер телефона $$$s$$$. Выведите <span class=\"tex-font-style-tt\">-1</span>, если такого разбиения получить нельзя.</p><p>В случае положительного ответа далее должны следовать $$$k$$$ строк, содержащие тройки чисел $$$l, r, i$$$. Такая тройка обозначает, что очередные $$$r-l+1$$$ цифр номера $$$s$$$ равны отрезку (подстроке) с границами $$$[l, r]$$$ телефона под номером $$$i$$$. И телефоны и цифры в них нумеруются от $$$1$$$. Обратите внимание, что $$$r-l+1 \\ge 2$$$ для всех $$$k$$$ строк.</p>"},"noteHtml":{"en":"<div class=\"section-title\">Note</div><p>The example from the statement.</p><p>In the second case, it is impossible to represent by segments of known numbers of length 2 or more.</p><p>In the third case, you can get the segments '<span class=\"tex-font-style-tt\">12</span>' and '<span class=\"tex-font-style-tt\">21</span>' from the first phone number.</p>","ru":"<div class=\"section-title\">Примечание</div><p>Первый тестовый случай соответствует примеру из условия.</p><p>Во втором случае невозможно представить отрезками известных номеров длины 2 или более.</p><p>В третьем случае можно получить отрезки «<span class=\"tex-font-style-tt\">12</span>» и «<span class=\"tex-font-style-tt\">21</span>» из первого номера телефона.</p>"},"sampleTestcases":[{"id":1641825510151,"input":"5\n\n4 8\n12340219\n20215601\n56782022\n12300678\n12345678\n\n2 3\n134\n126\n123\n\n1 4\n1210\n1221\n\n4 3\n251\n064\n859\n957\n054\n\n4 7\n7968636\n9486033\n4614224\n5454197\n9482268\n","output":"3\n1 4 1\n5 6 2\n3 4 3\n-1\n2\n1 2 1\n2 3 1\n-1\n3\n1 3 2\n5 6 3\n3 4 1\n"}],"submitUrl":"https://codeforces.com/contest/1624/submit","language":"c++","isPartOfContest":true}